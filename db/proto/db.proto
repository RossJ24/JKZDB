syntax = "proto3";

package db;

option go_package = "JKZDB/db/proto";


message SetEntryPrepareRequest {
    int64 idempotencyKey = 1;
    string key = 2;
    map<string, string> updates = 3;
}

message SetEntryPrepareResponse {}

message SetEntryCommitRequest {
    int64 idempotencyKey = 1;
    string key = 2;
    map<string, string> updates = 3;
}

message SetEntryCommitResponse {}

message SetEntryAbortRequest {
    int64 idempotencyKey = 1;
}

message SetEntryAbortResponse {}

message GetEntryByIdRequest{
    string id = 1;
}

message GetEntryByIdResponse{
    string entry = 1;
}

// For retrieving the id of a row using an indexed field.
message GetEntryByIndexedFieldRequest{
    string field = 1;
    string key = 2;
}

message GetEntryByIndexedFieldResponse{
    string entry = 1;
}

service JKZDB {
    rpc SetEntryPrepare(SetEntryPrepareRequest) returns(SetEntryPrepareResponse);

    rpc SetEntryCommit(SetEntryCommitRequest) returns(SetEntryCommitResponse);

    rpc SetEntryAbort(SetEntryAbortRequest) returns(SetEntryAbortResponse);

    rpc GetEntryById(GetEntryByIdRequest) returns(GetEntryByIdResponse);

    rpc GetEntryByIndexedField(GetEntryByIndexedFieldRequest) returns(GetEntryByIndexedFieldResponse);
}